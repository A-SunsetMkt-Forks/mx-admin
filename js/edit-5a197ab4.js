import{H as i}from"./rounded-button-31fc7a7e.js";import{d as w,i as b,v as A,x as S,cA as R,cZ as k,c_ as r,s as C,m as I,l as P,k as N,R as l,h as e,z as c,F as f,c$ as y,d0 as T,n as H,bk as h,bj as L}from"./index-703972d3.js";import{u as M}from"./use-parse-payload-70597db7.js";import{i as v}from"./isString-542f61a0.js";import{t as $}from"./transform-418b22dd.js";import{N as q}from"./Form-249453f6.js";import{N as m}from"./FormItem-a10558b4.js";import"./_arrayEach-2ff48152.js";import"./index-1a30543b.js";const U=w({setup(){const E=b(),p=A(),B=()=>({text:"",author:"",source:""}),s=S({});R(()=>{k([r.\u539F\u521B,r.\u54F2\u5B66,r.\u6587\u5B66,r.\u8BD7\u8BCD]).then(t=>{s.value={source:t.from,text:t.hitokoto,author:t.from_who||t.creator}})});const g=C(),x=async()=>{const t=async()=>{await l.api.says.post({data:s.value}),message.success("\u53D1\u5E03\u6210\u529F"),p.push({name:h.ListSay})};a.text||a.author||a.source?g.create({title:"\u8B66\u544A",content:"\u53D1\u5E03\u4E00\u8A00\u4F1A\u8986\u76D6\u73B0\u6709\u7684\u5185\u5BB9, \u8981\u7EE7\u7EED\u5417",type:"warning",negativeText:"\u53D6\u6D88",positiveText:"\u786E\u5B9A",onPositiveClick(){t()}}):t()},D=t=>M(a)(t),a=I(B()),n=P(()=>E.query.id);N(async()=>{const t=n.value;if(t&&typeof t=="string"){const o=(await l.api.says(t).get({})).data;D(o)}});const d=async()=>{const t=()=>{try{if(!a.text||a.text.trim().length==0)throw"\u5185\u5BB9\u4E3A\u7A7A";return{...$(L(a),(u,o,F)=>(u[F]=typeof o>"u"?null:typeof o=="string"&&o.length==0?"":o,u)),text:a.text.trim()}}catch(u){throw message.error(u),u}};if(n.value){if(!v(n.value))return;const u=n.value;await l.api.says(u).put({data:t()}),message.success("\u4FEE\u6539\u6210\u529F")}else await l.api.says.post({data:t()}),message.success("\u53D1\u5E03\u6210\u529F");p.push({name:h.ListSay})};return()=>e(H,{actionsElement:e(f,null,v(n)?e(i,{name:"\u66F4\u65B0",variant:"info",onClick:d,icon:e(y,null)}):e(f,null,e(i,{name:"\u53D1\u5E03\u4E00\u8A00",variant:"info",onClick:x,icon:e(T,null)}),e(i,{name:"\u53D1\u5E03\u81EA\u5DF1\u8BF4\u7684",variant:"primary",onClick:d,icon:e(y,null)})))},e(q,null,e(m,{label:"\u5185\u5BB9",required:!0,labelPlacement:"left",labelStyle:{width:"4rem"}},e(c,{type:"textarea",autofocus:!0,autosize:{minRows:6,maxRows:8},placeholder:s.value.text,value:a.text,onInput:t=>void(a.text=t)})),e(m,{label:"\u4F5C\u8005",labelPlacement:"left",labelStyle:{width:"4rem"}},e(c,{placeholder:s.value.author,value:a.author,onInput:t=>void(a.author=t)})),e(m,{label:"\u6765\u6E90",labelPlacement:"left",labelStyle:{width:"4rem"}},e(c,{placeholder:s.value.source,value:a.source,onInput:t=>void(a.source=t)}))))}});export{U as default};
