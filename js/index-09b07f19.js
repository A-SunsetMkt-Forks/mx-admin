import{H as g}from"./rounded-button-c4b84c49.js";import{f as N,y as s,m as h,R as u,a as t,C as v,F as y,d9 as x,L as b,b$ as c,N as T,b as f,bY as F,g as k,da as B,c0 as C}from"./index-1c0ad94e.js";import{T as E}from"./index-adf59b30.js";import{N as U,a as w,b as A}from"./Upload-1a3f7846.js";import{b as S}from"./Icon-f76d8766.js";import{N as I,a as M}from"./Tabs-f2676882.js";import{N as P}from"./ButtonGroup-d888b548.js";import{N as $}from"./Popconfirm-ee8ddab6.js";import"./DataTable-5246e860.js";import"./ChevronRight-46307fc8.js";import"./index-ddd9133d.js";import"./Tooltip-e28b7be1.js";import"./Select-d9659482.js";import"./Tag-df8d4ca0.js";import"./Pagination-d23d7cbf.js";import"./prop-a1682621.js";import"./Forward-ff40209a.js";import"./Add-703be64f.js";import"./throttle-492ebc44.js";var te=N({setup(){const l=s("icon"),r=s([]);h(()=>{u.api.files(l.value).get().then(({data:e})=>{r.value=e})});const n=s(!1),p=async e=>{if(l.value==="icon"){if(e.file.file?.type.startsWith("image"))return!0;message.error("\u53EA\u80FD\u4E0A\u4F20\u56FE\u7247\u6587\u4EF6\uFF0C\u8BF7\u91CD\u65B0\u4E0A\u4F20")}return!1},d=({file:e,event:a})=>{const o=a?.target,{url:i,name:m}=JSON.parse(o.responseText);return e.name=m,e.url=i,r.value.unshift({url:i,name:m}),e};return()=>t(v,{actionsElement:t(y,null,[t(g,{variant:"info",onClick:()=>{n.value=!0},icon:t(x,null,null)},null)])},{default:()=>[t(I,null,{default:()=>[t(M,{name:"\u56FE\u6807"},null)]}),t(E,{data:r,columns:[{key:"name",title:"\u6587\u4EF6\u540D",width:300,ellipsis:{lineClamp:1,tooltip:!0}},{key:"url",title:"URL",render(e){return t(b,{placement:"bottom",class:"w-[400px]"},{trigger(){return t("a",{href:e.url,target:"_blank"},[e.url])},default(){return t(c,{bordered:!0},{default:()=>[t(U,{src:e.url},null)]})}})}},{key:"action",title:"\u64CD\u4F5C",width:150,render(e){return t(P,null,{default:()=>[t($,{onPositiveClick:()=>{u.api.files(l.value)(e.name).delete().then(()=>{message.success("\u5220\u9664\u6210\u529F"),r.value=r.value.filter(a=>a.name!==e.name)})}},{trigger(){return t(T,{text:!0,type:"error",tertiary:!0,size:"tiny"},{default:()=>[f("\u5220\u9664")]})},default(){return`\u786E\u5B9A\u8981\u5220\u9664 ${e.name} \u5417\uFF1F`}})]})}}]},null),t(F,{closable:!0,closeOnEsc:!0,show:n.value,onUpdateShow:e=>{n.value=e}},{default:()=>[t(c,{title:"\u6587\u4EF6\u4E0A\u4F20",class:"modal-card sm flex justify-center",closable:!0},{default:()=>[t(w,{class:"flex flex-col items-center w-full",headers:{authorization:k()||""},action:`${u.endpoint}/files/upload?type=${l.value}`,"directory-dnd":!0,multiple:!0,onBeforeUpload:p,onFinish:d,onError:e=>{const a=e.event?.target;if(e.file.status="error",!a)return message.warning("\u7F51\u7EDC\u5F02\u5E38"),e.file;const{message:o}=JSON.parse(a.responseText);return message.warning(o),e.file}},{default:()=>[t(A,{class:"flex flex-col items-center justify-center w-full m-auto py-28"},{default:()=>[t(S,{size:"48",depth:"3"},{default:()=>[t(B,null,null)]}),t(C,{class:"mt-2"},{default:()=>[f("\u70B9\u51FB\u6216\u8005\u62D6\u52A8\u6587\u4EF6\u5230\u8BE5\u533A\u57DF\u6765\u4E0A\u4F20")]})]})]})]})]})]})}});export{te as default};
