import{R as u,A as h,p as y,r as N,d as w,k as b,a as x}from"./index-66557411.js";import{D as C}from"./delete-confirm-93a73628.js";import{R as P}from"./relative-time-926545d3.js";import{u as j}from"./use-table-86e8e7b0.js";import{d as k,a$ as D,X as E,al as F,w as R,o as A,h as e,O as B,N as M,bY as S,bZ as T,b_ as U,b$ as z,V as I,J as n,a4 as L,L as q,bn as H,c0 as V,c1 as _,bT as i}from"./vendor-a7b34205.js";import{H as $}from"./rounded-button-e182bc33.js";const Q=k({setup(){const{data:p,pager:r,sortProps:G,fetchDataFn:d,loading:f}=j((a,o)=>async(m=l.query.page||1,v=30)=>{const c=await u.api.projects.get({params:{page:m,size:v}});a.value=c.data,o.value=c.pagination}),t=D(new Set),g=E(),l=F(),s=d;return R(()=>l.query.page,async a=>{await s(a)}),A(async()=>{await s()}),()=>e(x,null,{actions:()=>e(B,null,e(C,{checkedRowKeys:t,onDelete:async()=>{await Promise.all(Array.from(t.values()).map(a=>u.api.projects(a).delete())),t.clear(),s()}}),e($,{to:"/projects/edit",icon:e(h,null)})),default:()=>e(M,{show:f.value},e(S,{bordered:!1,class:"min-h-[300px]"},{footer(){return e("div",{class:"flex justify-end"},e(T,{itemCount:r.value.total,pageCount:r.value.totalPage,page:r.value.currentPage,pageSize:r.value.size,onUpdatePage:a=>{s(a)}}))},default(){return p.value.map(a=>e(U,{key:a.id},{prefix(){return e(z,{class:"mt-4",checked:t.has(a.id),onUpdateChecked:o=>{o?t.add(a.id):t.delete(a.id)}})},default(){return e(I,{description:a.description},{header(){return e("div",null,e(n,{ghost:!0,type:"primary",text:!0,class:"!font-medium",...a.projectUrl?{tag:"a",href:a.projectUrl,target:"_blank"}:{}},a.name))},footer(){return e(L,null,e(q,{class:"pl-[3.6rem] text-[var(--clear-color-pressed)] text-sm"},e("span",null,"\u521B\u5EFA\u4E8E ",y(a.created)),a.modified&&e("span",null,"\u66F4\u65B0\u4E8E"," ",e(P,{time:a.modified}))))},"header-extra"(){return e(H,null,e(n,{onClick:()=>{N.push({name:w.EditProject,query:{id:a.id}})}},"\u7F16\u8F91"),e(V,{class:"!p-0",options:[{value:"del",label:"",render(){return e(n,{type:"error",bordered:!1,onClick:async()=>{await u.api.projects(a.id).delete(),g.success("\u5220\u9664\u6210\u529F"),await s(r.value.currentPage)}},"\u5220\u9664")}}]},e(n,{class:"!px-2"},e(_,null,e(b,null)))))},avatar(){return a.avatar?e(i,{class:"align-center",circle:!0,src:a.avatar,size:"large"}):e(i,{circle:!0,size:"large",class:"align-center"},a.name[0].toUpperCase())}})}}))}}))})}});export{Q as default};
