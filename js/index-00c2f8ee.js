import{H as k}from"./rounded-button-92024ad7.js";import{d as B,o as A,e as N,f,i as V,v as W,x as p,R as m,u as X,w as I,m as Y,s as Z,j as G,h as e,bU as Q,bX as M,z as S,p as ee,N as o,I as te,a as d,cr as ae,aZ as C,bl as ue,F as ne,n as le,cX as re,bY as q,W as b,E as P,U as se}from"./index-62e99b2b.js";import{T as oe}from"./index-477f2862.js";import{u as ie}from"./use-table-a2880f8a.js";import{N as ce,a as D}from"./Tabs-29728639.js";import{T as pe}from"./Trash-87b9cc9c.js";import{N as me}from"./Avatar-7371bbd5.js";import{N as de}from"./Form-1ff87b42.js";import{N as U}from"./FormItemRow-ce421b6e.js";import{N as ve}from"./Popconfirm-5f4696a2.js";import"./DataTable-30fbd207.js";import"./ChevronRight-9f5971e6.js";import"./Icon-aa605da4.js";import"./Select-5a24a54a.js";import"./Tag-ce864d2c.js";import"./Forward-91b8e448.js";import"./index-17f9ebb1.js";import"./Tooltip-b6bacdce.js";import"./Add-ff98d4f7.js";import"./throttle-cdd5b52c.js";import"./FormItem-382dc1be.js";const he={xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",viewBox:"0 0 24 24"},ge=f("g",{fill:"none"},[f("path",{d:"M17.5 12a5.5 5.5 0 1 1 0 10.999a5.5 5.5 0 0 1 0-11zM12 1.997c5.524 0 10.002 4.478 10.002 10.002c0 .263-.01.524-.03.782a6.503 6.503 0 0 0-1.475-1.052a8.501 8.501 0 1 0-8.765 8.767c.28.54.635 1.036 1.05 1.474c-.257.02-.518.03-.782.03c-5.524 0-10.002-4.478-10.002-10.001C1.998 6.476 6.476 1.998 12 1.998zm5.5 12l-.09.008a.5.5 0 0 0-.402.402l-.008.09v2.5L14.498 17l-.09.008a.5.5 0 0 0-.402.402l-.008.09l.008.09a.5.5 0 0 0 .402.402l.09.008H17v2.504l.008.09a.5.5 0 0 0 .402.401l.09.009l.09-.009a.5.5 0 0 0 .402-.402l.008-.09v-2.504l2.504.001l.09-.008a.5.5 0 0 0 .402-.402l.008-.09l-.008-.09a.5.5 0 0 0-.402-.402l-.09-.008H18v-2.5l-.008-.09a.5.5 0 0 0-.402-.403l-.09-.008zm-9.038.785a4.494 4.494 0 0 0 2.63 1.626a6.449 6.449 0 0 0-.079 1.51a5.982 5.982 0 0 1-3.73-2.208a.75.75 0 1 1 1.179-.928zM9 8.75a1.25 1.25 0 1 1 0 2.499A1.25 1.25 0 0 1 9 8.75zm6 0a1.25 1.25 0 1 1 0 2.499a1.25 1.25 0 0 1 0-2.499z",fill:"currentColor"})],-1),xe=[ge];var fe=B({name:"EmojiAdd24Regular",render:function(h,l){return A(),N("svg",he,xe)}});const Be={xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",viewBox:"0 0 512 512"},ye=f("path",{fill:"none",stroke:"currentColor","stroke-linecap":"square","stroke-miterlimit":"10","stroke-width":"44",d:"M416 128L192 384l-96-96"},null,-1),Fe=[ye];var we=B({name:"CheckmarkSharp",render:function(h,l){return A(),N("svg",Be,Fe)}});const Ee={xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",viewBox:"0 0 512 512"},ke=f("path",{d:"M400 145.49L366.51 112L256 222.51L145.49 112L112 145.49L222.51 256L112 366.51L145.49 400L256 289.49L366.51 400L400 366.51L289.49 256L400 145.49z",fill:"currentColor"},null,-1),Ce=[ke];var be=B({name:"CloseSharp",render:function(h,l){return A(),N("svg",Ee,Ce)}});const De=["(\u0E51\u2022\u0300\u3142\u2022\u0301)\u0648\u2727","(\xB0\u30FC\xB0\u3003)","o(\uFFE3\u30D8\uFFE3o\uFF03)","(\u0E51\xAF\u25E1\xAF\u0E51)","( \u2022\u0300 .\u032B \u2022\u0301 )\u2727","(\u3064\u0434\u2282)","(o\xB4\u03C9`o)","(\u2022\u0C6A\u2022 )","(>\u25BD<)","(\u0E51\u2022\u0300\u3142\u2022\u0301) \u2727","\u10DA(\u2579\u25E1\u2579\u10DA)","_(:\u0437\u300D\u2220)_","\u053E\u2038\u053E"," \u0295 \u2022\u0300 o \u2022\u0301 \u0294"," (\u2449\uFF65\u0306\u2313\uFF65\u0306\u2449)"," \u266B.(\u25D5\u2220\u25D5).\u266B"," | \u2022\u0301 \u25BE \u2022\u0300 |"," \u3033 \xB0 \u25BE \xB0 \u3035"," | \u2022\u0301 \u25BE \u2022\u0300 |"," \u22CB\u254F \u275B \u25E1 \u275B \u254F\u22CC"," (\u30FB\u2200\u30FB)"," (^\u30FB\u03C9\u30FB^ )","(\xB4\uFF65\u03C9\uFF65`)  ","(\u0E51\xB4\u3142`\u0E51) ","(\u0E51\u02D8 \u2083\u02D8\u0E51) ","(\u25CF\u2019\u03C9`\u25CF\uFF09","(\xB4\uFF65\u03C9\uFF65`)  "];var _=(u=>(u[u.Unread=0]="Unread",u[u.Read=1]="Read",u[u.Junk=2]="Junk",u))(_||{});const Xe=B(()=>{const u=V(),h=W(),l=p(+u.query.state),{data:z,checkedRowKeys:n,fetchDataFn:$,pager:H,loading:J}=ie((t,a)=>async(s=u.query.page||1,E=10)=>{const x=u.query.state,L=await m.api.comments.get({params:{page:s,size:E,state:x|0}});t.value=L.data,a.value=L.pagination}),y=X(),v=p(!1),r=p(null),i=p(""),F=p(),w=p(!1),R=async()=>{if(!!r.value)try{w.value=!0,await m.api.comments.master.reply(r.value.id).post({data:{text:i.value}}),v.value=!1,r.value=null,y.success("\u56DE\u590D\u6210\u529F\u5566~"),i.value="",await c()}finally{w.value=!1}},c=$;I(()=>u.query.page,async t=>{await c(t)},{immediate:!0}),I(()=>u.query.state,async t=>{z.value=[],n.value=[],C(()=>c())});async function g(t,a){Array.isArray(t)?await Promise.all(t.map(s=>m.api.comments(s).patch({data:{state:a}}))):await m.api.comments(t).patch({data:{state:a}}),y.success("\u64CD\u4F5C\u5B8C\u6210"),await c()}async function T(t){if(Array.isArray(t))try{await Promise.all(t.map(a=>m.api.comments(a).delete({errorHandler:s=>{}})))}catch{}else await m.api.comments(t).delete();await c(),y.success("\u5220\u9664\u6210\u529F")}const j=Y([{title:"",key:"avatar",width:60,render(t){return e(me,{circle:!0,src:t.avatar})}},{title:"\u4F5C\u8005",key:"author",width:200,render(t,a){return e(d,{vertical:!0,size:2},e("a",{href:t.url||"#",target:"_blank",rel:"noreferrer"},t.author),e("a",{href:"mailto:"+t.mail||"",target:"_blank"},t.mail),e("div",null,e(re,{ip:t.ip,trigger:"hover",triggerEl:e(q,{depth:"3",class:"select-all"},t.ip)})))}},{title:"\u5185\u5BB9",key:"text",render(t){const a=(()=>{switch(t.refType){case"Post":return b+"/posts/"+t.ref.category.slug+"/"+t.ref.slug;case"Note":return b+"/notes/"+t.ref.nid;case"Page":return b+"/"+t.ref.slug}})();return e(d,{vertical:!0,size:2},e(d,{size:5},e("span",null,P(t.created)),e("span",null,"\u4E8E"),e("a",{href:a,target:"_blank"},t.ref.title)),e("p",null,t.text),t.parent&&e("blockquote",{class:"border-l-[3px] border-solid border-primary-default pl-[12px] my-2 ml-4"},e(d,{size:2,align:"center"},e(q,{depth:"2"},t.parent.author,"\xA0\u5728\xA0",P(t.parent.created),"\xA0\u8BF4:\xA0",t.parent.text))),e("div",{class:"space-x-3"},l.value!==1&&e(o,{text:!0,size:"tiny",type:"success",onClick:()=>g(t.id,1)},"\u5DF2\u8BFB"),l.value!==2&&e(o,{text:!0,size:"tiny",type:"warning",onClick:()=>g(t.id,2)},"\u5783\u573E"),l.value!==2&&e(o,{text:!0,size:"tiny",type:"info",onClick:s=>{r.value=t,v.value=!0}},"\u56DE\u590D"),e(ve,{positiveText:"\u53D6\u6D88",negativeText:"\u5220\u9664",onNegativeClick:()=>{T(t.id)}},{trigger:()=>e(o,{text:!0,size:"tiny",type:"error"},"\u5220\u9664"),default:()=>e("span",{class:"max-w-48"},"\u786E\u5B9A\u8981\u5220\u9664 ",t.title," ?")})))}}]),K=Z(),{viewport:O}=G(se);return()=>e(le,{actionsElement:e(ne,null,l.value!==1&&e(k,{name:"\u5DF2\u8BFB",disabled:n.value.length===0,icon:e(we,null),variant:"success",onClick:()=>{g(n.value,_.Read),n.value.length=0}}),l.value!==2&&e(k,{name:"\u6807\u8BB0\u4E3A\u5783\u573E",disabled:n.value.length===0,icon:e(pe,null),variant:"warning",onClick:()=>{g(n.value,_.Junk),n.value.length=0}}),e(k,{name:"\u5220\u9664",icon:e(be,null),variant:"error",disabled:n.value.length===0,onClick:()=>{K.warning({title:"\u8B66\u544A",content:"\u4F60\u786E\u5B9A\u8981\u5220\u9664\u591A\u6761\u8BC4\u8BBA\uFF1F",negativeText:"\u786E\u5B9A",positiveText:"\u4E0D\u786E\u5B9A",onNegativeClick:async()=>{await T(n.value),n.value.length=0}})}}))},e(ce,{size:"medium",value:l.value,onUpdateValue:t=>{h.replace({name:ue.Comment,query:{state:t}}).then(()=>{l.value=t})}},e(D,{name:0,tab:"\u672A\u8BFB"},e("div",{class:""})),e(D,{name:1,tab:"\u5DF2\u8BFB"},e("div",{class:""})),e(D,{name:2,tab:"\u5783\u573E"},e("div",{class:""}))),e(oe,{maxWidth:600,data:z,loading:J.value,onFetchData:c,pager:H,onUpdateCheckedRowKeys:t=>{n.value=t},columns:[{type:"selection",options:["none","all"],width:30},...j]}),e(Q,{transformOrigin:"center",show:!!v.value,onUpdateShow:t=>{t||(v.value=t)}},r.value&&e(M,{style:"width: 500px;max-width: 90vw",headerStyle:{textAlign:"center"},title:"\u56DE\u590D: "+r.value.author},e(de,{onSubmit:R},e(U,{label:r.value.author+" \u8BF4:"},e(S,{disabled:!0,value:r.value.text,type:"textarea",autosize:{minRows:4,maxRows:10}})),e(U,{label:"\u56DE\u590D\u5185\u5BB9"},e(S,{ref:F,value:i.value,type:"textarea",onInput:t=>i.value=t,autosize:{minRows:4,maxRows:10}})),e("div",{class:"flex justify-between"},e(ee,{trigger:"click",placement:O.value.mobile?"top-end":"left"},{trigger(){return e(o,{text:!0,class:"text-[20px]"},e(te,null,e(fe,null)))},default(){return e(M,{style:"max-width: 300px",bordered:!1},e(d,{align:"center",class:"!justify-between"},De.map(t=>e(o,{text:!0,key:t,type:"primary",onClick:()=>{if(!F.value)return;const a=ae(F.value).textareaElRef;a.focus(),C(()=>{const s=a.selectionStart,E=a.selectionEnd;a.value=a.value.substring(0,s)+` ${t} `+a.value.substring(E,a.value.length),i.value=a.value,C(()=>{const x=s+t.length+2;a.selectionStart=x,a.selectionEnd=x,a.focus()})})}},t))))}}),e(d,{size:12,align:"center",inline:!0},e(o,{type:"success",onClick:R,round:!0,loading:w.value},"\u786E\u5B9A"),e(o,{onClick:()=>{i.value="",v.value=!1},round:!0},"\u53D6\u6D88")))))))});export{Xe as default};
