import{H as i}from"./rounded-button-e182bc33.js";import{h as w,S as l,R as r,i as h,a as F,d as y}from"./index-66557411.js";import{u as S}from"./use-parse-payload-ee448945.js";import{d as A,al as R,u as C,r as I,W as P,H as k,a$ as H,t as T,o as N,h as t,bh as L,ba as c,G as m,O as f,bf as v,aa as M,bU as $,be as q}from"./vendor-a7b34205.js";const W=A({setup(){const E=R(),d=C(),B=()=>({text:"",author:"",source:""}),s=I({});P(()=>{w([l.\u539F\u521B,l.\u54F2\u5B66,l.\u6587\u5B66,l.\u8BD7\u8BCD]).then(e=>{s.value={source:e.from,text:e.hitokoto,author:e.from_who||e.creator}})});const g=k(),D=async()=>{const e=async()=>{await r.api.says.post({data:s.value}),message.success("\u53D1\u5E03\u6210\u529F"),d.push({name:y.ListSay})};a.text||a.author||a.source?g.create({title:"\u8B66\u544A",content:"\u53D1\u5E03\u4E00\u8A00\u4F1A\u8986\u76D6\u73B0\u6709\u7684\u5185\u5BB9, \u8981\u7EE7\u7EED\u5417",type:"warning",negativeText:"\u53D6\u6D88",positiveText:"\u786E\u5B9A",onPositiveClick(){e()}}):e()},b=e=>S(a)(e),a=H(B()),n=T(()=>E.query.id);N(async()=>{const e=n.value;if(e&&typeof e=="string"){const o=(await r.api.says(e).get({})).data;b(o)}});const p=async()=>{const e=()=>{try{if(!a.text||a.text.trim().length==0)throw"\u5185\u5BB9\u4E3A\u7A7A";return{...$(q(a),(u,o,x)=>(u[x]=typeof o>"u"?null:typeof o=="string"&&o.length==0?"":o,u)),text:a.text.trim()}}catch(u){throw message.error(u),u}};if(n.value){if(!v(n.value))return;const u=n.value;await r.api.says(u).put({data:e()}),message.success("\u4FEE\u6539\u6210\u529F")}else await r.api.says.post({data:e()}),message.success("\u53D1\u5E03\u6210\u529F");d.push({name:y.ListSay})};return()=>t(F,{actionsElement:t(f,null,v(n)?t(i,{name:"\u66F4\u65B0",variant:"info",onClick:p,icon:t(h,null)}):t(f,null,t(i,{name:"\u53D1\u5E03\u4E00\u8A00",variant:"info",onClick:D,icon:t(M,null)}),t(i,{name:"\u53D1\u5E03\u81EA\u5DF1\u8BF4\u7684",variant:"primary",onClick:p,icon:t(h,null)})))},t(L,null,t(c,{label:"\u5185\u5BB9",required:!0,labelPlacement:"left",labelStyle:{width:"4rem"}},t(m,{type:"textarea",autofocus:!0,autosize:{minRows:6,maxRows:8},placeholder:s.value.text,value:a.text,onInput:e=>void(a.text=e)})),t(c,{label:"\u4F5C\u8005",labelPlacement:"left",labelStyle:{width:"4rem"}},t(m,{placeholder:s.value.author,value:a.author,onInput:e=>void(a.author=e)})),t(c,{label:"\u6765\u6E90",labelPlacement:"left",labelStyle:{width:"4rem"}},t(m,{placeholder:s.value.source,value:a.source,onInput:e=>void(a.source=e)}))))}});export{W as default};
