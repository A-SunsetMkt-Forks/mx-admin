import{d as l,R as i,u as F,q as v,f as w,w as x,j as k,l as C,h as t,p,N as d,a as R,F as B,A as T,m as E}from"./index-4d27830d.js";import{D as N}from"./delete-confirm-6634e8cf.js";import{T as A}from"./index-a7c3d2d1.js";import{R as S}from"./relative-time-90dd8dc7.js";import{u as L}from"./use-table-c0861ac4.js";import{H as M}from"./rounded-button-0526cb28.js";import{N as b}from"./Popconfirm-4e478b6b.js";import"./DataTable-5b87b626.js";import"./Icon-50c2f7b3.js";import"./Select-8cb7e266.js";import"./Tag-15d88ccb.js";import"./Forward-cf94cb5b.js";import"./index-4bc2c49d.js";import"./ChevronRight-2cb45c00.js";import"./Tooltip-16d72ba3.js";const Z=l({name:"SayList",setup(q,K){const{checkedRowKeys:u,data:m,pager:o,loading:y,fetchDataFn:f}=L((a,e)=>async(h=n.query.page||1,D=30)=>{const c=await i.api.says.get({params:{page:h,size:D,select:"title text _id id created modified author source"}});a.value=c.data,e.value=c.pagination}),r=F();v();const n=w(),s=f;x(()=>n.query.page,async a=>{await s(a)}),k(async()=>{await s()});const g=l({setup(){const a=C([{type:"selection",options:["none","all"]},{title:"\u521B\u5EFA\u4E8E",key:"created",width:100,render(e){return t(p,{to:"/says/edit?id="+e.id},t(S,{time:e.created}))}},{title:"\u5185\u5BB9",key:"text"},{title:"\u4F5C\u8005",key:"author"},{title:"\u6765\u6E90",key:"source"},{title:"\u64CD\u4F5C",fixed:"right",key:"id",width:130,render(e){return t(R,{wrap:!1},t(p,{to:"/says/edit?id="+e.id},t(d,{text:!0,type:"primary",size:"tiny"},"\u7F16\u8F91")),t(b,{positiveText:"\u53D6\u6D88",negativeText:"\u5220\u9664",onNegativeClick:async()=>{await i.api.says(e.id).delete(),r.success("\u5220\u9664\u6210\u529F"),await s(o.value.currentPage)}},{trigger:()=>t(d,{text:!0,type:"error",size:"tiny"},"\u79FB\u9664"),default:()=>t("span",{class:"max-w-48"},"\u786E\u5B9A\u8981\u5220\u9664\u201C",e.text,"\u201D ?")}))}}]);return()=>t(A,{loading:y.value,columns:a,data:m,onFetchData:s,pager:o,onUpdateCheckedRowKeys:e=>{u.value=e}})}});return()=>t(E,null,{actions:()=>t(B,null,t(N,{checkedRowKeys:u.value,onDelete:async()=>{const a=await Promise.allSettled(u.value.map(e=>i.api.says(e).delete()));for(const e of a)e.status==="rejected"&&r.success("\u5220\u9664\u5931\u8D25\uFF0C"+e.reason.message);u.value.length=0,s()}}),t(M,{to:"/says/edit",icon:t(T,null)})),default:()=>t(g,null)})}});export{Z as default};
