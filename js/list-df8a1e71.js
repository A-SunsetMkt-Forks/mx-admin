import{R as o,A as v,a as w}from"./index-66557411.js";import{D as F}from"./delete-confirm-93a73628.js";import{T as x}from"./index-bfc15a67.js";import{R as k}from"./relative-time-926545d3.js";import{u as C}from"./use-table-86e8e7b0.js";import{d as l,X as R,H as B,al as T,w as E,o as b,a$ as A,h as t,b4 as d,J as p,L,b1 as S,O as M}from"./vendor-a7b34205.js";import{H as N}from"./rounded-button-e182bc33.js";const U=l({name:"SayList",setup(H,K){const{checkedRowKeys:u,data:m,pager:i,loading:y,fetchDataFn:f}=C((a,e)=>async(h=r.query.page||1,D=30)=>{const c=await o.api.says.get({params:{page:h,size:D,select:"title text _id id created modified author source"}});a.value=c.data,e.value=c.pagination}),n=R();B();const r=T(),s=f;E(()=>r.query.page,async a=>{await s(a)}),b(async()=>{await s()});const g=l({setup(){const a=A([{type:"selection",options:["none","all"]},{title:"\u521B\u5EFA\u4E8E",key:"created",width:100,render(e){return t(d,{to:"/says/edit?id="+e.id},t(k,{time:e.created}))}},{title:"\u5185\u5BB9",key:"text"},{title:"\u4F5C\u8005",key:"author"},{title:"\u6765\u6E90",key:"source"},{title:"\u64CD\u4F5C",fixed:"right",key:"id",width:130,render(e){return t(L,{wrap:!1},t(d,{to:"/says/edit?id="+e.id},t(p,{text:!0,type:"primary",size:"tiny"},"\u7F16\u8F91")),t(S,{positiveText:"\u53D6\u6D88",negativeText:"\u5220\u9664",onNegativeClick:async()=>{await o.api.says(e.id).delete(),n.success("\u5220\u9664\u6210\u529F"),await s(i.value.currentPage)}},{trigger:()=>t(p,{text:!0,type:"error",size:"tiny"},"\u79FB\u9664"),default:()=>t("span",{class:"max-w-48"},"\u786E\u5B9A\u8981\u5220\u9664\u201C",e.text,"\u201D ?")}))}}]);return()=>t(x,{loading:y.value,columns:a,data:m,onFetchData:s,pager:i,onUpdateCheckedRowKeys:e=>{u.value=e}})}});return()=>t(w,null,{actions:()=>t(M,null,t(F,{checkedRowKeys:u.value,onDelete:async()=>{const a=await Promise.allSettled(u.value.map(e=>o.api.says(e).delete()));for(const e of a)e.status==="rejected"&&n.success("\u5220\u9664\u5931\u8D25\uFF0C"+e.reason.message);u.value.length=0,s()}}),t(N,{to:"/says/edit",icon:t(v,null)})),default:()=>t(g,null)})}});export{U as default};
